<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HaDeX package • HaDeX</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="HaDeX package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HaDeX</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">HaDeX package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="overview_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="overview_files/jquery-1.12.4/jquery.min.js"></script><link href="overview_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="overview_files/datatables-binding-0.5/datatables.js"></script><link href="overview_files/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="overview_files/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="overview_files/dt-core-1.10.16/js/jquery.dataTables.min.js"></script><link href="overview_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
<script src="overview_files/crosstalk-1.0.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>HaDeX package</h1>
                        <h4 class="author">Weronika Puchała, Michał Burdukiewicz</h4>
            
            <h4 class="date">15.02.2019</h4>
      
      
      <div class="hidden name"><code>overview.Rmd</code></div>

    </div>

    
    
<p>This vignette is work-in-progress and not yet complete.</p>
<div id="hydrogendeuterium-exchange-mass-spectrometry-data" class="section level1">
<h1 class="hasAnchor">
<a href="#hydrogendeuterium-exchange-mass-spectrometry-data" class="anchor"></a>Hydrogen/Deuterium Exchange Mass Spectrometry Data</h1>
<p>Hydrogen-deuterium mass spectrometry (HDX-MS) is a staple tool for monitoring dynamics and interactions of proteins. Due to the sheer size of the HDX-MS results, the data analysis require a dedicated software suite. However, the majority of existing tools provides only point-and-click interfaces to black-box models or does not offer a complete workflow. We propose HaDeX, a novel tool for processing, analysis and visualisation of HDX-MS experiments. HaDeX covers the whole analytic process, including preliminary data exploration, quality control and generation of publication-quality figures. The reproducibility of the whole procedure is ensured with advanced reporting functions.</p>
</div>
<div id="general-data-manipulation" class="section level1">
<h1 class="hasAnchor">
<a href="#general-data-manipulation" class="anchor"></a>General data manipulation</h1>
<p>All of the functions mentioned below are wrapped together in the HaDeX Shiny app. It is launched by calling HaDeX_gui() function.</p>
<div id="input-file-format" class="section level2">
<h2 class="hasAnchor">
<a href="#input-file-format" class="anchor"></a>Input file format</h2>
<p>The HaDeX web server relies only on a single data format: DynamX datafile. The user can customize each step of the analysis with his own input parameters.</p>
</div>
<div id="transformation-of-data-and-measurement-uncertainty" class="section level2">
<h2 class="hasAnchor">
<a href="#transformation-of-data-and-measurement-uncertainty" class="anchor"></a>Transformation of data and measurement uncertainty</h2>
<p>The uploaded datafile should fulfill the following requirements in order for package functions to behave correctly:</p>
<div id="htmlwidget-702e554d0b7a349fc91f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-702e554d0b7a349fc91f">{"x":{"filter":"none","data":[["Protein","Start","End","Sequence","Modification","Fragment","MaxUptake","MHP","State","Exposure","File","z","RT","Inten","Center"],["Character","Integer","Integer","Character","Logic","Logic","Numeric","Numeric","Character","Numeric","Character","Integer","Numeric","Numeric","Numeric"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Column.Name<\/th>\n      <th>Column.Type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","autoWidth":true,"pageLength":15,"order":[],"orderClasses":false,"lengthMenu":[10,15,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>This is a structure of datafile produced by DynamX 3. In upcoming versions of HaDeX more datafile types will be supported.</p>
<p>Datafile is imported into R usign function read_hdx(). Currently, HaDeX supports .csv, .tsv and .xls files - with mentioned structure. File loaded this way is later referred as dat.</p>
<p>The example file, used for further demonstration:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_hdx.html">read_hdx</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="dt">package =</span> <span class="st">"HaDeX"</span>, <span class="st">"HaDeX/data/KD_190304_Nucb2_EDTA_CaCl2_test02_clusterdata.csv"</span>))</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Protein = col_character(),
##   Start = col_double(),
##   End = col_double(),
##   Sequence = col_character(),
##   Modification = col_logical(),
##   Fragment = col_logical(),
##   MaxUptake = col_double(),
##   MHP = col_double(),
##   State = col_character(),
##   Exposure = col_double(),
##   File = col_character(),
##   z = col_double(),
##   RT = col_double(),
##   Inten = col_double(),
##   Center = col_double()
## )</code></pre>
<div id="protein-coverage" class="section level3">
<h3 class="hasAnchor">
<a href="#protein-coverage" class="anchor"></a>Protein coverage</h3>
<p>First information user can get is protein sequence reconstruction based on supplemented data. Although the sequence should be known to the experimenter, it is useful to see how the sequence was covered in the experiment. Function reconstruct_sequence() does that:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/reconstruct_sequence.html">reconstruct_sequence</a></span>(dat)</code></pre></div>
<pre><code>## [1] "xxxxxxxxxxxxxxxxVPIDIDKTKVKGEGHVEGEKIENPDTGLYYDEYLRQVIDVLETDKHFREKLQTADIEEIKSGKLSRELDLVSHHVRTRLDELKRQEVARLRMLIKAKMDSVQDTGIDHQALLKQFEHLNHQNPDTFEPKDLDMLIKAATSDLENYDKTRHEEFKKYEMxxxxxxxxxxxxLDEEKRQREESKFGEMxxxxxxxxxxxxxxxxxxxKEVWEEADGLDPNEFDPKTFFKLHDVNNDRFLDEQELEAxFTKELEKVYDPKNEEDDMVEMEEERLxxxxHVMNEVDINKDRLVTLEEFLRATEKKEFLEPDSWETLDQQQLFTEDELKEFESHISQQEDELRKKAEELQKQKEELQRQHDQLQAQEQELQQVVKQMEQKKLQQANPPAGPAGELK"</code></pre>
<p>Unknown amino acids are marked as x according to the IUPAC conventions.</p>
<p>Additionally, coverage information can be presented on a plot using function graphic_overlapping(). Peptides positions are shown next to each other for easier data overview.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/graphic_overlapping.html">graphic_overlapping</a></span>(dat, <span class="dt">chosen_state =</span> <span class="st">"gg_Nucb2_CaCl2"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>User can choose which state (or states) should be included in shown data. If this parameter is not supplied, the first possible state is chosen. If given peptide data is available in more than one state, is shown once for readability.</p>
</div>
<div id="data-preparation-for-deuteration-calculations" class="section level3">
<h3 class="hasAnchor">
<a href="#data-preparation-for-deuteration-calculations" class="anchor"></a>Data preparation for deuteration calculations</h3>
<p>There are a few steps of preliminary data preparation. All of the listed transformation in this section is done by prepare_dataset() function. Product of calling prepare_dataset() on data read by read_hdx() is later referred as calc_dat.</p>
<div id="measured-data-to-useful-value" class="section level4">
<h4 class="hasAnchor">
<a href="#measured-data-to-useful-value" class="anchor"></a>Measured data to useful value</h4>
<p>DynamX provides experimental data as measured mass plus proton mass to charge ratio (<span class="math inline">\(Center\)</span>). For later use, this value has to be transformed into overall peptide mass, as shown in equation 1:</p>
<p><span class="math display">\[expMass = z*(Center-protonMass)\tag{1}\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(expMass\)</span> - result calculated from partial values</p></li>
<li><p><span class="math inline">\(z\)</span> - charge</p></li>
<li><p><span class="math inline">\(Center\)</span> - experimentally measured value - mass plus proton mass per charge ratio</p></li>
</ul>
<p>This transformation is applied to every measurement.</p>
<p>The experiment is repeated at least three times for the results to be reliable. Then, the repetitions are aggregated as weighted mean into one result per peptide using equation 2:</p>
<p><span class="math display">\[expMass = \frac{Inten*expMass}{N}\tag{2}\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(Inten\)</span> - Intensivity</p></li>
<li><p><span class="math inline">\(N\)</span> - number of repetitions</p></li>
</ul>
<p>In input file is data from more than one measurement. The mean value for each time in each state is treated as a result. This means that the uncertainty is calculated using the standard deviation of the mean:</p>
<p><span class="math display">\[u(x) = \sqrt{\frac{ \sum_{i=1}^n \left( x_{i} - \overline{x} \right)^2}{n(n-1)}}\tag{3}\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(x_{i}\)</span> - measurement</p></li>
<li><p><span class="math inline">\(\overline{x}\)</span> - mean value</p></li>
<li><p><span class="math inline">\(n\)</span> - number of measurements</p></li>
</ul>
</div>
<div id="experimental-deuteration-level" class="section level4">
<h4 class="hasAnchor">
<a href="#experimental-deuteration-level" class="anchor"></a>Experimental deuteration level</h4>
<p>In HDX-MS experiments the subject of interest is deuteration level exchanged in a given time between two states. Generally, the experimental relative deuteration level is calculated as shown in equation 4. It is a function of three variables and produces a value for the chosen state and chosen time <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[D = \frac{D_{t} - D_{0}}{D_{100} - D_{0}}\tag{4}\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(D\)</span> - deuteration level (relative value)</p></li>
<li><p><span class="math inline">\(D_{0}\)</span> - deuteration in <span class="math inline">\(in\)</span> time (0 or close to 0, measured) - mean value obtained as explained before</p></li>
<li><p><span class="math inline">\(D_{100}\)</span> - deuteration in <span class="math inline">\(out\)</span> time (possibly big, at least 1440 [min]) - mean value obtainted as explained before</p></li>
<li><p><span class="math inline">\(D_{t}\)</span> - deuteration measured in chosen time - mean value obtainted as explained before</p></li>
</ul>
<p>Although equation 4 produces relative value, absolute values are also calculated in HaDeX adjusting the equation to its variance as shown in equation 4a:</p>
<p><span class="math display">\[D = D_{t} - D_{0}\tag{4a}\]</span> Functions in HaDeX package contain logical value <span class="math inline">\(relative\)</span> to determine if values should be absolute or relative. Methodology below is described on relative values for readability. Absolute values are obtained analogical way - just without scaling.</p>
<p>To calculate uncertainty related to functions of more than one variables (eq. equation 4) the Law of propagation of uncertainty is defined by equation 5:</p>
<p><span class="math display">\[u_{c}(y) = \sqrt{\sum_{k} \left[ \frac{\partial y}{\partial x_{k}} u(x_{k}) \right]^2}\tag{5}\]</span></p>
<p>Uncorrelatedness is assumed.</p>
<p>Adapting equation 5 using formula from equation 4, uncertainty of equation 4 is calculated as follows:</p>
<p><span class="math display">\[u_{c}(D) = \sqrt{\sum_{k} \left[ \frac{\partial D}{\partial D_{k}} u(D_{k}) \right]^2 }\tag{6}\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(k \in {0, t, 100}\)</span></p></li>
<li><p><span class="math inline">\(D_{k}\)</span> - deuteration in k time</p></li>
<li><p><span class="math inline">\(u(D_{k})\)</span> - uncertainty associated with <span class="math inline">\(D_{k}\)</span> as standard deviation of the mean value</p></li>
</ul>
<p>Then, expanding the equation 6:</p>
<p><span class="math display">\[u_{c}(D) = \sqrt{ \left[ \frac{1}{D_{100}-D_{0}} u(D_{t}) \right]^2 + \left[ \frac{D_{t} - D_{100}}{(D_{100}-D_{0})^2} u(D_{0}) \right]^2 + \left[ \frac{D_{0} - D_{t}}{(D_{100}-D_{0})^2} u(D_{100}) \right]^2}\tag{7}\]</span> As suspected, the uncertainty associated with <span class="math inline">\(D_{t}\)</span> has the biggest impact on <span class="math inline">\(u_{c}(D)\)</span>.</p>
</div>
<div id="theoretical-deuteration-level" class="section level4">
<h4 class="hasAnchor">
<a href="#theoretical-deuteration-level" class="anchor"></a>Theoretical deuteration level</h4>
<p>Other way to examine the data rather then experimental way are the theoertical calculations - obtained relative deuteration level in chosen time <span class="math inline">\(t\)</span> is compared with theoretical values as shown in equation 8:</p>
<p><span class="math display">\[D = \frac{D_{t}-MHP}{MaxUptake*protonMass}\tag{8}\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(D_{t}\)</span> - deuteration measured in chosen time</p></li>
<li><p><span class="math inline">\(MHP\)</span> - theoretical mass for peptide (constant)</p></li>
<li><p><span class="math inline">\(MaxUptake\)</span> - max proton uptake for peptide (constant)</p></li>
<li><p><span class="math inline">\(protonMass\)</span> - mass of a proton (constant).</p></li>
</ul>
<p>Absolute value is calculates as in equation 8 without scalling, as shown in equation 8a:</p>
<p><span class="math display">\[D = D_{t} - MHP\tag{8a}\]</span></p>
<p>The uncertainty of the function of one variable is defined by the equation 9:</p>
<p><span class="math display">\[u(y) = \left| \frac{dy}{dx} u(x) \right|\tag{9}\]</span></p>
<p>and based on equation 8:</p>
<p><span class="math display">\[u(D) = \left|\frac{1}{MaxUptake*protonMass} u(D_{t}) \right|\tag{10}\]</span></p>
<p>For the absolute values, <span class="math inline">\(u(D)\)</span> is identical with <span class="math inline">\(u(D_{t})\)</span>, based on equation 8a and 9.</p>
<div id="difference-of-deuteration-levels-between-two-states" class="section level5">
<h5 class="hasAnchor">
<a href="#difference-of-deuteration-levels-between-two-states" class="anchor"></a>Difference of deuteration levels between two states</h5>
<p>Interesting observance can be gained from analysing the difference of deuteration levels in given time <span class="math inline">\(t\)</span> between two states as shown in plot in Woods format. For this, deuteration level in one state <span class="math inline">\((D_{2})\)</span> is subtracted from deuteration level in other state <span class="math inline">\((D_{1})\)</span>:</p>
<p><span class="math display">\[diff = D_{1} - D_{2}\tag{11}\]</span></p>
<p>and the uncertainty of function of two variables (based on equation 11 and 5):</p>
<p><span class="math display">\[u_{c}(diff) = \sqrt{u(D_{1})^2 + u(D_{2})^2}\tag{12}\]</span> All of the previous calculations are done by function prepare_dataset(). Example of use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">calc_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/prepare_dataset.html">prepare_dataset</a></span>(dat,
                            <span class="dt">in_state_first =</span> <span class="st">"gg_Nucb2_EDTA_0.001"</span>,
                            <span class="dt">chosen_state_first =</span> <span class="st">"gg_Nucb2_EDTA_25"</span>,
                            <span class="dt">out_state_first =</span> <span class="st">"gg_Nucb2_EDTA_1440"</span>,
                            <span class="dt">in_state_second =</span> <span class="st">"gg_Nucb2_CaCl2_0.001"</span>,
                            <span class="dt">chosen_state_second =</span> <span class="st">"gg_Nucb2_CaCl2_25"</span>,
                            <span class="dt">out_state_second =</span> <span class="st">"gg_Nucb2_CaCl2_1440"</span>) </code></pre></div>
</div>
</div>
</div>
<div id="comparison-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#comparison-plot" class="anchor"></a>Comparison plot</h3>
<p>The levels of deuteration along with uncertainty intervals are shown on comparison plot. HaDeX provides both experimental and theoretical levels of deuteration in either relative or absolute values. Example of use:</p>
<p>– theoretical:</p>
<ul>
<li>relative values:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat,
                <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
                <span class="dt">relative =</span> <span class="ot">TRUE</span>,
                <span class="dt">state_first =</span> <span class="st">"Nucb2 Factor 1"</span>,
                <span class="dt">state_second =</span> <span class="st">"Nucb2 Factor 2"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged in state comparison in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<ul>
<li>absolute values:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat,
                <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
                <span class="dt">relative =</span> <span class="ot">FALSE</span>,
                <span class="dt">state_first =</span> <span class="st">"Nucb2 Factor 1"</span>,
                <span class="dt">state_second =</span> <span class="st">"Nucb2 Factor 2"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged in state comparison in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>– experimental:</p>
<ul>
<li>relative values:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat,
                <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
                <span class="dt">relative =</span> <span class="ot">TRUE</span>, 
                <span class="dt">state_first =</span> <span class="st">"Nucb2 Factor 1"</span>,
                <span class="dt">state_second =</span> <span class="st">"Nucb2 Factor 2"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Fraction exchanged in state comparison in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<ul>
<li>absolute values:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat,
                <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
                <span class="dt">relative =</span> <span class="ot">FALSE</span>, 
                <span class="dt">state_first =</span> <span class="st">"Nucb2 Factor 1"</span>,
                <span class="dt">state_second =</span> <span class="st">"Nucb2 Factor 2"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Fraction exchanged in state comparison in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div id="woods-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#woods-plot" class="anchor"></a>Woods plot</h3>
<p>Woods plot format shows the difference between the results of two different states as described by equation 11. HaDeX provides both experimental and theoretical calculations in either relative or absolute values. Example of use:</p>
<p>– theoretical:</p>
<ul>
<li>relative values:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat,
           <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
           <span class="dt">relative =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged between states in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<ul>
<li>absolute values:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat,
           <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
           <span class="dt">relative =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged between states in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>– experimental:</p>
<ul>
<li>relative values:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat,
           <span class="dt">theoretical =</span> <span class="ot">FALSE</span>, 
           <span class="dt">relative =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged between states in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<ul>
<li>absolute values:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat,
           <span class="dt">theoretical =</span> <span class="ot">FALSE</span>, 
           <span class="dt">relative =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged between states in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</div>
<div id="confidence-limit-in-woods-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#confidence-limit-in-woods-plot" class="anchor"></a>Confidence limit in Woods plot</h3>
<p>The function calculate_confidence_limit_values() calculates confidence limit values the way that is described in Houde, D., Berkowitz, S.A., and Engen, J.R. (2011). The Utility of Hydrogen/Deuterium Exchange Mass Spectrometry in Biopharmaceutical Comparability Studies. J Pharm Sci 100, 2071–2086.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/calculate_confidence_limit_values.html">calculate_confidence_limit_values</a></span>(<span class="dt">calc_dat =</span> calc_dat,
                                  <span class="dt">confidence_limit =</span> <span class="fl">0.99</span>,
                                  <span class="dt">theoretical =</span> <span class="ot">FALSE</span>, 
                                  <span class="dt">relative =</span> <span class="ot">TRUE</span>)  </code></pre></div>
<pre><code>## [1] -0.1159129  0.1159129</code></pre>
<p>Function add_stat_dependency() returns calc_dat extended by column describing relation of given peptide with confidence limit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/add_stat_dependency.html">add_stat_dependency</a></span>(calc_dat, 
                   <span class="dt">confidence_limit =</span> <span class="fl">0.98</span>, 
                   <span class="dt">theoretical =</span> <span class="ot">FALSE</span>, 
                   <span class="dt">relative =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## # A tibble: 108 x 29
##    Sequence Start   End Med_Sequence frac_exch_state… err_frac_exch_s…
##    &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1 VPIDID      17    22         19.5          NaN             NaN     
##  2 KTKVKGE…    23    44         33.5          NaN             NaN     
##  3 YYDEY       45    49         47              0.975           0.0703
##  4 YYDEYL      45    50         47.5            0.679           0.0396
##  5 YLRQVID     49    55         52              0.453           0.0223
##  6 YLRQVIDV    49    56         52.5            0.428           0.0246
##  7 YLRQVID…    49    57         53              0.417           0.0194
##  8 LRQVID      50    55         52.5            0.520           0.0467
##  9 LRQVIDV     50    56         53              0.450           0.0176
## 10 LRQVIDVL    50    57         53.5            0.414           0.0247
## # … with 98 more rows, and 23 more variables: frac_exch_state_2 &lt;dbl&gt;,
## #   err_frac_exch_state_2 &lt;dbl&gt;, diff_frac_exch &lt;dbl&gt;,
## #   err_frac_exch &lt;dbl&gt;, abs_frac_exch_state_1 &lt;dbl&gt;,
## #   err_abs_frac_exch_state_1 &lt;dbl&gt;, abs_frac_exch_state_2 &lt;dbl&gt;,
## #   err_abs_frac_exch_state_2 &lt;dbl&gt;, abs_diff_frac_exch &lt;dbl&gt;,
## #   err_abs_diff_frac_exch &lt;dbl&gt;, avg_theo_in_time_1 &lt;dbl&gt;,
## #   err_avg_theo_in_time_1 &lt;dbl&gt;, avg_theo_in_time_2 &lt;dbl&gt;,
## #   err_avg_theo_in_time_2 &lt;dbl&gt;, diff_theo_frac_exch &lt;dbl&gt;,
## #   err_diff_theo_frac_exch &lt;dbl&gt;, abs_avg_theo_in_time_1 &lt;dbl&gt;,
## #   err_abs_avg_theo_in_time_1 &lt;dbl&gt;, abs_avg_theo_in_time_2 &lt;dbl&gt;,
## #   err_abs_avg_theo_in_time_2 &lt;dbl&gt;, abs_diff_theo_frac_exch &lt;dbl&gt;,
## #   err_abs_diff_theo_frac_exch &lt;dbl&gt;, valid_at_0.98 &lt;lgl&gt;</code></pre>
</div>
</div>
<div id="additional-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-tools" class="anchor"></a>Additional tools</h2>
<p>HaDeX provides additional tools for assement of experiments.</p>
<div id="quality-control" class="section level3">
<h3 class="hasAnchor">
<a href="#quality-control" class="anchor"></a>Quality control</h3>
<p>Function quality_control() shows how the mean uncertainty per peptide changes with time points of an experiment. Example of use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/quality_control.html">quality_control</a></span>(<span class="dt">dat =</span> dat,
                          <span class="dt">state_first =</span> <span class="st">"gg_Nucb2_EDTA"</span>,
                          <span class="dt">state_second =</span> <span class="st">"gg_Nucb2_CaCl2"</span>, 
                          <span class="dt">chosen_time =</span> <span class="dv">25</span>, 
                          <span class="dt">in_time =</span> <span class="fl">0.001</span>, 
                          <span class="dt">relative =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>As the function returns data.frame with calculated value, here is an example of result visualization:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(result[result[<span class="st">"time"</span>]<span class="op">&gt;=</span><span class="dv">1</span>,]) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> avg_err_state_first, <span class="dt">color =</span> <span class="st">"Average error (first state)"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> avg_err_state_second, <span class="dt">color =</span> <span class="st">"Average error (second state)"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"log(time) [min]"</span>, <span class="dt">y =</span> <span class="st">"Average uncertainty"</span>, <span class="dt">title =</span> <span class="st">"Uncertainty change"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_bw</span>(<span class="dt">base_size =</span> <span class="dv">11</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>,
        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p>Example above is based on relative values. Although HaDeX provides results in absolute values, be aware that absolute calculations don’t contain time out (it is used for scaling), so the uncertainty is not the function of <span class="math inline">\(D_{100}\)</span> - it is constant.</p>
</div>
</div>
</div>
<div id="example-workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#example-workflow" class="anchor"></a>Example workflow</h1>
<ol style="list-style-type: decimal">
<li>File import</li>
<li>Sequence reconstruction</li>
<li>Woods plots.</li>
</ol>
<div id="example-workflow-1" class="section level2">
<h2 class="hasAnchor">
<a href="#example-workflow-1" class="anchor"></a>Example workflow 1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(HaDeX)

<span class="co"># file import</span>
dat_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_hdx.html">read_hdx</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="dt">package =</span> <span class="st">"HaDeX"</span>, <span class="st">"HaDeX/data/KD_180110_CD160_HVEM.csv"</span>))</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Protein = col_character(),
##   Start = col_double(),
##   End = col_double(),
##   Sequence = col_character(),
##   Modification = col_logical(),
##   Fragment = col_logical(),
##   MaxUptake = col_double(),
##   MHP = col_double(),
##   State = col_character(),
##   Exposure = col_double(),
##   File = col_character(),
##   z = col_double(),
##   RT = col_double(),
##   Inten = col_double(),
##   Center = col_double()
## )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># protein sequence reconstruction</span>
<span class="kw"><a href="../reference/reconstruct_sequence.html">reconstruct_sequence</a></span>(dat_<span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] "INITSSASQEGTRLNLICTVWHKKEEAEGFVVFLCKDRSGDCSPETSLKQLRLKRDPGIDGVGEISSQLMFTISQVTPLHSGTYQCCARSQKSGIRLQGHFFSILFxxxxxxxxxxxxxxxxxxFSHNEGTL"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate data</span>
calc_dat_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/prepare_dataset.html">prepare_dataset</a></span>(<span class="dt">dat =</span> dat_<span class="dv">1</span>,
                              <span class="dt">in_state_first =</span> <span class="st">"CD160_0.001"</span>,
                              <span class="dt">chosen_state_first =</span> <span class="st">"CD160_1"</span>,
                              <span class="dt">out_state_first =</span> <span class="st">"CD160_1440"</span>,
                              <span class="dt">in_state_second =</span> <span class="st">"CD160_HVEM_0.001"</span>,
                              <span class="dt">chosen_state_second =</span> <span class="st">"CD160_HVEM_1"</span>,
                              <span class="dt">out_state_second =</span> <span class="st">"CD160_HVEM_1440"</span>)                             

<span class="co"># theoretical comparison plot - relative values</span>
<span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">1</span>,
                <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
                <span class="dt">relative =</span> <span class="ot">TRUE</span>, 
                <span class="dt">state_first =</span> <span class="st">"CD160"</span>,
                <span class="dt">state_second =</span> <span class="st">"CD160_HVEM"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># experimental comparison plot - relative values</span>
<span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">1</span>,
                <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
                <span class="dt">relative =</span> <span class="ot">TRUE</span>,
                <span class="dt">state_first =</span> <span class="st">"CD160"</span>,
                <span class="dt">state_second =</span> <span class="st">"CD160_HVEM"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-19-2.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># theoretical comparison plot - absolute values</span>
<span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">1</span>,
                <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
                <span class="dt">relative =</span> <span class="ot">FALSE</span>, 
                <span class="dt">state_first =</span> <span class="st">"CD160"</span>,
                <span class="dt">state_second =</span> <span class="st">"CD160_HVEM"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-19-3.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># experimental comparison plot - absolute values</span>
<span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">1</span>,
                <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
                <span class="dt">relative =</span> <span class="ot">FALSE</span>,
                <span class="dt">state_first =</span> <span class="st">"CD160"</span>,
                <span class="dt">state_second =</span> <span class="st">"CD160_HVEM"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-19-4.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># theoretical Woods plot - relative values</span>
<span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">1</span>,
           <span class="dt">theoretical =</span> <span class="ot">TRUE</span>, 
           <span class="dt">relative =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span>.<span class="dv">2</span>, .<span class="dv">2</span>))</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-19-5.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># experimental Woods plot - relative values</span>
<span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">1</span>,
           <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
           <span class="dt">relative =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span>.<span class="dv">2</span>, .<span class="dv">2</span>))</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-19-6.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># theoretical Woods plot - absolute values</span>
<span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">1</span>,
           <span class="dt">theoretical =</span> <span class="ot">TRUE</span>, 
           <span class="dt">relative =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged between states in 1 min time"</span>) </code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-19-7.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># experimental Woods plot - absolute values</span>
<span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">1</span>,
           <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
           <span class="dt">relative =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Fraction exchanged between states in 1 min time"</span>) </code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-19-8.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># quality control - relative values </span>
(result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/quality_control.html">quality_control</a></span>(<span class="dt">dat =</span> dat_<span class="dv">1</span>,
                <span class="dt">state_first =</span> <span class="st">"CD160"</span>,
                <span class="dt">state_second =</span> <span class="st">"CD160_HVEM"</span>, 
                <span class="dt">chosen_time =</span> <span class="dv">1</span>, 
                <span class="dt">in_time =</span> <span class="fl">0.001</span>))</code></pre></div>
<pre><code>##       time avg_err_state_first sd_err_state_first avg_err_state_second
## 1    0.167          0.02726432        0.034505648           0.04002412
## 2    1.000          0.01809028        0.024756735           0.03441546
## 3    5.000          0.02047067        0.014970305           0.02662301
## 4   25.000          0.01457019        0.010830460           0.02364142
## 5  120.000          0.01487203        0.008620807           0.01947143
## 6 1440.000          0.01291996        0.007112112           0.01780559
##   sd_err_state_second avg_err_theo_state_first sd_err_theo_state_first
## 1         0.052382299              0.004956604             0.003506281
## 2         0.046121220              0.004956604             0.003506281
## 3         0.031301883              0.004956604             0.003506281
## 4         0.025624532              0.004956604             0.003506281
## 5         0.013984848              0.004956604             0.003506281
## 6         0.007831976              0.004956604             0.003506281
##   avg_err_theo_state_second sd_err_theo_state_second   avg_diff
## 1               0.008696022              0.003880989 0.04910158
## 2               0.008696022              0.003880989 0.03980257
## 3               0.008696022              0.003880989 0.03439911
## 4               0.008696022              0.003880989 0.02836936
## 5               0.008696022              0.003880989 0.02448255
## 6               0.008696022              0.003880989 0.02248423
##       sd_diff avg_theo_diff sd_theo_diff
## 1 0.062186906    0.01036691  0.004459795
## 2 0.051630286    0.01036691  0.004459795
## 3 0.033868351    0.01036691  0.004459795
## 4 0.027193051    0.01036691  0.004459795
## 5 0.014771291    0.01036691  0.004459795
## 6 0.009476601    0.01036691  0.004459795</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example quality control visualisation</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(result) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> time, <span class="dt">y =</span> avg_err_state_first, <span class="dt">color =</span> <span class="st">"Average error (first state)"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> time, <span class="dt">y =</span> avg_err_state_second, <span class="dt">color =</span> <span class="st">"Average error (second state)"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_continuous">scale_x_log10</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/lims">ylim</a></span>(<span class="dv">0</span>, <span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"log(time) [min]"</span>, <span class="dt">y =</span> <span class="st">"Average uncertainty"</span>, <span class="dt">title =</span> <span class="st">"Uncertainty change in out time"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.title =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_blank</a></span>(),
        <span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-19-9.png" width="672"></p>
</div>
<div id="example-workflow-2" class="section level2">
<h2 class="hasAnchor">
<a href="#example-workflow-2" class="anchor"></a>Example workflow 2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(HaDeX)

<span class="co"># file import</span>
dat_<span class="dv">2</span> &lt;-<span class="st">  </span><span class="kw"><a href="../reference/read_hdx.html">read_hdx</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="dt">package =</span> <span class="st">"HaDeX"</span>, <span class="st">"HaDeX/data/KD_190304_Nucb2_EDTA_CaCl2_test02_clusterdata.csv"</span>))</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Protein = col_character(),
##   Start = col_double(),
##   End = col_double(),
##   Sequence = col_character(),
##   Modification = col_logical(),
##   Fragment = col_logical(),
##   MaxUptake = col_double(),
##   MHP = col_double(),
##   State = col_character(),
##   Exposure = col_double(),
##   File = col_character(),
##   z = col_double(),
##   RT = col_double(),
##   Inten = col_double(),
##   Center = col_double()
## )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># protein sequence reconstruction</span>
<span class="kw"><a href="../reference/reconstruct_sequence.html">reconstruct_sequence</a></span>(dat_<span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] "xxxxxxxxxxxxxxxxVPIDIDKTKVKGEGHVEGEKIENPDTGLYYDEYLRQVIDVLETDKHFREKLQTADIEEIKSGKLSRELDLVSHHVRTRLDELKRQEVARLRMLIKAKMDSVQDTGIDHQALLKQFEHLNHQNPDTFEPKDLDMLIKAATSDLENYDKTRHEEFKKYEMxxxxxxxxxxxxLDEEKRQREESKFGEMxxxxxxxxxxxxxxxxxxxKEVWEEADGLDPNEFDPKTFFKLHDVNNDRFLDEQELEAxFTKELEKVYDPKNEEDDMVEMEEERLxxxxHVMNEVDINKDRLVTLEEFLRATEKKEFLEPDSWETLDQQQLFTEDELKEFESHISQQEDELRKKAEELQKQKEELQRQHDQLQAQEQELQQVVKQMEQKKLQQANPPAGPAGELK"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate data</span>
calc_dat_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/prepare_dataset.html">prepare_dataset</a></span>(<span class="dt">dat =</span> dat_<span class="dv">2</span>,
                              <span class="dt">in_state_first =</span> <span class="st">"gg_Nucb2_EDTA_0.001"</span>,
                              <span class="dt">chosen_state_first =</span> <span class="st">"gg_Nucb2_EDTA_25"</span>,
                              <span class="dt">out_state_first =</span> <span class="st">"gg_Nucb2_EDTA_1440"</span>,
                              <span class="dt">in_state_second =</span> <span class="st">"gg_Nucb2_CaCl2_0.001"</span>,
                              <span class="dt">chosen_state_second =</span> <span class="st">"gg_Nucb2_CaCl2_25"</span>,
                              <span class="dt">out_state_second =</span> <span class="st">"gg_Nucb2_CaCl2_1440"</span>)                             

<span class="co"># theoretical comparison plot - relative values</span>
<span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">2</span>,
                <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
                <span class="dt">relative =</span> <span class="ot">TRUE</span>,
                <span class="dt">state_first =</span> <span class="st">"Nucb2 Factor 1"</span>,
                <span class="dt">state_second =</span> <span class="st">"Nucb2 Factor 2"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged in </span><span class="ch">\n</span><span class="st">state comparison in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># experimental comparison plot - relative values </span>
<span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">2</span>,
                <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
                <span class="dt">relative =</span> <span class="ot">TRUE</span>,
                <span class="dt">state_first =</span> <span class="st">"Nucb2 Factor 1"</span>,
                <span class="dt">state_second =</span> <span class="st">"Nucb2 Factor 2"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Fraction exchanged in </span><span class="ch">\n</span><span class="st">state comparison in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-2.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># theoretical comparison plot - absolute values</span>
<span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">2</span>,
                <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
                <span class="dt">relative =</span> <span class="ot">FALSE</span>,
                <span class="dt">state_first =</span> <span class="st">"Nucb2 Factor 1"</span>,
                <span class="dt">state_second =</span> <span class="st">"Nucb2 Factor 2"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged in </span><span class="ch">\n</span><span class="st">state comparison in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-3.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># experimental comparison plot - absolute values </span>
<span class="kw"><a href="../reference/comparison_plot.html">comparison_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">2</span>,
                <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
                <span class="dt">relative =</span> <span class="ot">FALSE</span>,
                <span class="dt">state_first =</span> <span class="st">"Nucb2 Factor 1"</span>,
                <span class="dt">state_second =</span> <span class="st">"Nucb2 Factor 2"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Fraction exchanged in </span><span class="ch">\n</span><span class="st">state comparison in 25 min time"</span>)</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-4.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># theoretical Woods plot - relative values</span>
<span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">2</span>,
           <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
           <span class="dt">relative =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged between states in 25 min time"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/coord_cartesian">coord_cartesian</a></span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span>.<span class="dv">5</span>, .<span class="dv">7</span>))</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-5.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># experimental Woods plot - relative values</span>
<span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">2</span>,
           <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
           <span class="dt">relative =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Fraction exchanged between states in 25 min time"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/coord_cartesian">coord_cartesian</a></span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span>.<span class="dv">5</span>, .<span class="dv">7</span>))</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-6.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># theoretical Woods plot - absolute values</span>
<span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">2</span>,
           <span class="dt">theoretical =</span> <span class="ot">TRUE</span>,
           <span class="dt">relative =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Theoretical fraction exchanged between states in 25 min time"</span>) </code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-7.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># experimental Woods plot - absolute values</span>
<span class="kw"><a href="../reference/woods_plot.html">woods_plot</a></span>(<span class="dt">calc_dat =</span> calc_dat_<span class="dv">2</span>,
           <span class="dt">theoretical =</span> <span class="ot">FALSE</span>,
           <span class="dt">relative =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Fraction exchanged between states in 25 min time"</span>) </code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-8.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># quality control</span>
(result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/quality_control.html">quality_control</a></span>(<span class="dt">dat =</span> dat_<span class="dv">2</span>,
                           <span class="dt">state_first =</span> <span class="st">"gg_Nucb2_EDTA"</span>,
                           <span class="dt">state_second =</span> <span class="st">"gg_Nucb2_CaCl2"</span>, 
                           <span class="dt">chosen_time =</span> <span class="dv">25</span>, 
                           <span class="dt">in_time =</span> <span class="fl">0.001</span>))</code></pre></div>
<pre><code>##       time avg_err_state_first sd_err_state_first avg_err_state_second
## 1    0.167          1.12668796         2.67936864           5.74943215
## 2    1.000          0.21865923         0.43638639           0.55627020
## 3   10.000          0.04752637         0.04018654           0.06668929
## 4   25.000          0.04139853         0.02327421           0.06825437
## 5   60.000          0.03952259         0.01897687           0.05062340
## 6 1440.000          0.03800095         0.01757703           0.04863807
##   sd_err_state_second avg_err_theo_state_first sd_err_theo_state_first
## 1         18.07924217              0.009947346             0.004380806
## 2          1.04342126              0.009947346             0.004380806
## 3          0.03635610              0.009947346             0.004380806
## 4          0.01964438              0.009947346             0.004380806
## 5          0.01476658              0.009947346             0.004380806
## 6          0.01429207              0.009947346             0.004380806
##   avg_err_theo_state_second sd_err_theo_state_second   avg_diff    sd_diff
## 1                0.01809629              0.005315552 4.03180732 8.94704424
## 2                0.01809629              0.005315552 0.57283531 0.99399397
## 3                0.01809629              0.005315552 0.08370555 0.04349920
## 4                0.01809629              0.005315552 0.08170489 0.01991455
## 5                0.01809629              0.005315552 0.06492766 0.01761838
## 6                0.01809629              0.005315552 0.06179983 0.01941685
##   avg_theo_diff sd_theo_diff
## 1    0.02124735  0.004765375
## 2    0.02124735  0.004765375
## 3    0.02124735  0.004765375
## 4    0.02124735  0.004765375
## 5    0.02124735  0.004765375
## 6    0.02124735  0.004765375</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example quality control visualisation - relative values</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(result[result[<span class="st">"time"</span>]<span class="op">&gt;=</span><span class="dv">1</span>,]) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> time, <span class="dt">y =</span> avg_err_state_first, <span class="dt">color =</span> <span class="st">"Average error (first state)"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> time, <span class="dt">y =</span> avg_err_state_second, <span class="dt">color =</span> <span class="st">"Average error (second state)"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_continuous">scale_x_log10</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"log(time) [min]"</span>, <span class="dt">y =</span> <span class="st">"Average uncertainty"</span>, <span class="dt">title =</span> <span class="st">"Uncertainty change"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>,
        <span class="dt">legend.title =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_blank</a></span>())</code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-20-9.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#hydrogendeuterium-exchange-mass-spectrometry-data">Hydrogen/Deuterium Exchange Mass Spectrometry Data</a></li>
      <li>
<a href="#general-data-manipulation">General data manipulation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#input-file-format">Input file format</a></li>
      <li><a href="#transformation-of-data-and-measurement-uncertainty">Transformation of data and measurement uncertainty</a></li>
      <li><a href="#additional-tools">Additional tools</a></li>
      </ul>
</li>
      <li>
<a href="#example-workflow">Example workflow</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-workflow-1">Example workflow 1</a></li>
      <li><a href="#example-workflow-2">Example workflow 2</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
